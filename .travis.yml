language: rust
sudo: false
before_script:
  - export CC=clang
  - export CXX=clang++
  - export LOCAL=~/.local
  - export PATH=${LOCAL}/bin:${PATH}
addons:
  apt:
    packages:
    - libcurl4-openssl-dev
    - libelf-dev
    - libdw-dev
after_success:
  - git clone https://github.com/SimonKagstrom/kcov.git
  - mkdir kcov/build
  - cd kcov/build
  - cmake -DCMAKE_INSTALL_PREFIX:PATH=${LOCAL} ..
  - make -j$(nproc)
  - make install
  - cd ../..
  - kcov --coveralls-id=${TRAVIS_JOB_ID} --exclude-pattern=/.cargo target/kcov target/debug/gannai-*
